# RunAny已更新最新版本！感谢你的使用和支持！[![HitCount](http://hits.dwyl.io/hui-Zz/RunAny.svg)](http://hits.dwyl.io/hui-Zz/RunAny)

#### 📢 关注RunAny一劳永逸微信公众号，分享【一劳永逸】的效率软件和解决方案！
![RunAny公众号-白色版](/assets/images/RunAny公众号-白色版.jpg)
## 【RunAny】v5.7.1 2020-04-14
【新增】：
1. RunAny菜单支持双列多列显示（如下面图片展示效果）  
  - 在`RunAny.ini`里想要分隔的菜单项之前添加一行：  
    一个竖杠 `|`    =>  变成无边框的双列菜单  
    两个竖杠`||`    =>  变成有边框的双列菜单  
2. RunAny菜单图标可以改变大小：在RunAny设置 —— 图标设置
3. 最近运行项添加到 菜单2、选中文件、选中文字菜单
4. 新增插件功能：
  - huiZz_Windows.ahk v1.0.6 打开当前窗口进程所在目录

【优化】：
1. 修复部分快捷方式在菜单中失效并隐藏的问题
2. 插件管理中 自启的脚本在RunAny启动后，检测到已启动，会先关闭掉再启动
3. 同一菜单中菜单项名称相同，自动在末尾添加“重名”二字
4. 解决RunAny偶尔无法正确重启或新运行一个RunAny的问题
5. 一键Everything 对选中文件夹按热键变为搜索该文件夹内所有文件
6. 解决一些情况下 最近运行项数量及图标不正确的问题
7. “新增修改菜单项”界面按Ctrl+V自动添加值到各个编辑框中

【多列菜单效果展示】：
![RunAny横向菜单展示](/assets/images/RunAny横向菜单展示.png)

## 【RunAny】v5.7.0 2020-03-31
?> **新版本RunAny热键选中文字默认不再自动隐藏exe程序**  
**如果需要选中文字只显示某些分类菜单，可以修改菜单分类项的文件后缀里添加`text`**

![RunAny新增修改菜单分类5.7](/assets/images/RunAny新增修改菜单分类5.7.jpg)

**【新增功能】：**
+ **<font color="red">菜单变量功能，可以使用 系统环境变量/AHK内置变量/用户自定义值变量</font>**
+ 评估RunAny初始化时间，显示在任务栏托盘图标的鼠标悬停提示
  + 菜单不同时间加载，刚开机也无需等待直接使用：
    + 任务栏红色RA图标时：无图标菜单、无路径应用功能不可用
    + 任务栏红色Z图标：无图标菜单，大部分功能可使用
    + 任务栏标准RA图标：有图标，完整功能菜单
+ 最近运行项可以设置扩大数量，不再固定2个，建议1-9个，可以使用快捷数字来运行
+ 热字符串提示可设置相对于鼠标坐标
+ 插件管理新增插件库功能，可以管理其他目录的AHK脚本
+ 新增插件：
  + huiZz_BatchRun.ahk 1.1.1：`多软件打开选中多文件|huiZz_BatchRun[multi_open](%getZz%,"notepad.exe","wordpad.exe")`
  + huiZz_System.ahk 1.0.6：`管理员权限运行选中目标|huiZz_System[system_runas_zz](%getZz%)`
  + huiZz_Text.ahk 1.1.0：
  ```
  uri转中文|huiZz_Text[text_encode_zz](%getZz%,uri,cn)
  中文转uri|huiZz_Text[text_encode_zz](%getZz%,cn,uri)
  unicode转中文|huiZz_Text[text_encode_zz](%getZz%,unicode,cn)
  中文转unicode|huiZz_Text[text_encode_zz](%getZz%,cn,unicode)
  ```

**【优化功能】：**
* **精简/优化/重构菜单新建、运行、过滤等相关代码**
* 修改菜单树界面可以单独新增分类​
* 热键配置界面优化，可以手写AHK热键支持更多特殊热键
* 修复移动RunAny目录后，开机启动选项依然错误勾选的问题
* 后缀公共菜单的顺序与主菜单一致
* 选中内容多种类型时不输出公式结果
* 带参数的程序用热键运行始终新运行一个
* 自动备份RunAny配置文件名可以设置格式


## 【RunAny】v5.6.9 2020-01-06
**【新增功能】：**
+ RunAny自动备份配置文件，可限制最多数量
+ RunAny处理搜索结果优先最新版本同名exe全路径
  + 打开此选项后就完美支持了Scoop这类软件库中的软件，无路径也能自动定位到最新版本的EXE程序
  + 如果电脑上同名软件过多可能会减慢RunAny初始加载速度，根据自己需求开关
+ 按需搜索模式（只搜索RunAny菜单的无路径文件）
  + 不再生效搜索参数  `file:*.exe|*.lnk|*.ahk|*.bat|*.cmd`
  + 任意在RunAny菜单中的后缀文件都可以无路径运行
  + 注意：开启后会影响RunAny所有设置和插件脚本的无路径识别，不在RunAny.ini菜单内的程序无法自动识别全路径

**【新增插件】：**
+ huiZz_BatchRun - ObjReg批量自定义运行
  + 批量自定义运行
  + 多软件打开选中文件
+ huiZz_Work - ObjReg工作相关脚本
  + 快捷一键发送邮件：发送剪贴板内容给选中邮箱地址的邮件
  + 老板键Win+D最小化其他窗口，同时打开指定程序

+ **全面优化调整菜单树管理界面，支持自定义图标显示，颜色标识**
+ 支持后缀文件exe,bat,cmd,vbs,ps1,ahk带有参数运行
+ 修改全局热键和热字符串时进行验证是否已经被使用
* RunAny设置界面和说明优化


## 【RunAny】v5.6.8
+ 精简了实用配置文件等，移到了在线网页文档，方便以后实时更新，总体积到5.46MB
+ 增加：ObjReg插件点击“插件说明”按钮跳转到说明文档网页
+ 设置中“隐藏失效项”隐藏RunAny菜单中失效的快捷方式
+ RunAny默认支持过滤掉scoop的目录shims同名exe
* 没安装AHK环境时编辑插件用记事本方式打开脚本
* 修复了同时使用多个RunAny时的自动重启问题
* 选中文字打开菜单会显示带有%getZz%和%s的菜单项
* 修复码云gitee文本导致插件下载界面乱码问题

## 【RunAny】v5.6.6 ~ v5.6.7

由于最新版Windows Defender又又抽风误杀Ahk2Exe编译方式的RunAny.exe，所以从RunAny5.6.6版本开始不再编译exe，采用AutoHotkey.exe改名+调用RunAny.ahk的形式，不会影响任何功能使用。另外，以后手动只需要更新RunAny.ahk文件即可
> （如有需要编译版，安装AutoHotkey后在Compiler目录运行命令：Ahk2Exe.exe /in "RunAny.ahk脚本路径" /icon "编译图标路径"）

+ 新增选项：管理员权限运行所有软件和插件
* 设置界面优化
* 运行程序部分代码重构优化、版本更新下载优化
* 选中文字菜单、后缀菜单中分类菜单和公共菜单的自定义图标都能正确显示了~


## 【RunAny】v5.6.1 ~ v5.6.5
+ [便利新功能]
  + 热字符串生效前增加自动联想提示
    + 热字符串提示支持最大截取字数、透明度等配置
  + 新增模拟打字输出短语模式末尾;;
    + 此模式除输出短语外 \`n和\`r转换为Enter键击  \`t转换为Tab键击  \`b转换为Backspace键击
    + 可用于自动输入自动登录确认等功能
  + 菜单项启动路径增加RunAny变量%getZz%
    + %getZz%在运行时会转换为你鼠标选中的文本内容
  + 新增RunAny九种启动菜单方式
  + RunAny.ini配置文件手动修改后自动重启

* [新增修改菜单项界面翻新]
  * 直观设置热字符串和透明度、实时显示和修改启动路径模式
  * 修改菜单换行和Tab制表符可以自动以\`n和\`t保存和读取

+ [插件新增]
  + 自定义程序自动中英输入法

* [优化]
  * RunAny更新地址优先使用码云gitee，国内更新大大加快
  * 后缀菜单中增加 显示菜单全部
  * 新增默认菜单图标主题两种：浅色和暗色
    * 文件夹MenuIcon、MenuIcon2
  * 修改文件、插件管理、检查更新可用隐藏配置修改掉图标


## 【RunAny】v5.6.0
+ 增加一套默认菜单图标主题，感谢群友Waiting的创作~
+ 插件管理中添加“新建插件”按钮，快捷创建自己的RunAny插件
+ 新增插件：选中文字生成二维码，ObjReg二维码脚本
  + v1.1.1 根据选中文字数量自动调整二维码大小
+ huiZz_Text插件新增功能
  + [文本删除重复行保留顺序]
  + [网络路径命名]、[文件路径命名]
* huiZz_Text插件修复全小写转驼峰不正确的问题

## 【RunAny】v5.5.9 徽章显示🔰
+ 重新设计"关于RunAny"，直观显示Github项目信息
+ 新增修改菜单项“相对路径”切换按钮，使路径不易失效，大大减少需要修改配置的次数
+ 不选中文字时隐藏带%s搜索网址和菜单
* 修复ObjReg插件中无路径没有处理,识别为系统自带软件的问题
* 解决程序参数有竖杠|时冲突

![RunAny相对路径功能演示](/assets/images/RunAny相对路径功能演示.gif)

## 【RunAny】v5.5.8
1. 按住<kbd>Ctrl</kbd>打开软件会打开软件所在的目录
2. **按住<kbd>Shift</kbd>键打开软件快速直接跳转到编辑该菜单项**
3. 按住<kbd>Ctrl</kbd>+<kbd>Shift</kbd>键打开软件会以管理员身份来运行
#### 重磅新功能：
+ **【热字符串启动菜单项】☀**
  + 热字符串：`冒号:` + 选项 + `冒号:` + 热字符，写在菜单别名后面末尾里，例如：`QQ:*X:#QQ|QQ.exe`
  + 选项说明：`星号*`代表无需按结束按键(回车Tab等)，`大写X`代表动态执行而不是当作短语输出字符
  + `#QQ`代表任何情况下(屏蔽RunAny程序列表除外)先按<kbd>#</kbd>再按<kbd>Q</kbd><kbd>Q</kbd>，就会直接运行QQ！
  + 输出短语：`:*X:hg@|hui0.0713@gmail.com;`在任何地方按<kbd>h</kbd><kbd>g</kbd><kbd>@</kbd>即可快捷输出邮箱地址！
  + **（注意：井号#可以为任意打字不常用字符，避免聊天时误按了几下QQ就运行QQ了！！）**
  > 透明启动情况：`_:数字`依然在别名末尾，热字符在其前面，如：`Sublime:*X:@sub_:88|sublime_text.exe`

+ 添加联动功能：公共后缀菜单 public
  + 此功能是支持同时使用自定义后缀菜单后和插件菜单，例如：`-系统函数(&S)|public`
  + 在函数菜单名|后求填入public即表示该菜单为公共菜单，该菜单内容会在任意后缀菜单中显示
  + 如原来选中视频文件仅弹出视频相关软件，现在自动出现系统函数菜单，可以使用复制文件名称路径等操作

* 修复几处图标加载问题，即使图标加载失败也不影响使用
* 修复 选中内容后网址短语函数菜单的没有分隔符的问题

## 【RunAny】插件功能
+ ResourcesExtract提取生成RunAny菜单中的所有EXE程序图标，加快菜单启动50%以上速度
+ 文本函数功能`示例[文本函数.ini]`：[文本多行合并],[文本替换],[文本格式化],[文本排序],[便捷运行磁力链接],[选中文本比较剪贴板]
+ 窗口函数功能`示例[窗口函数.ini]`：[窗口居中],[窗口改变大小],[窗口置顶],[窗口边角置顶观影],[窗口透明度],[窗口置顶时设置透明],[窗口最大化并隐藏标题栏]
+ 系统函数功能`示例[系统函数.ini]`：[显示系统隐藏文件],[定位注册表路径],[获取本地IP],[复制名称],[复制路径]...

## 【RunAny】v5.5.5~v5.5.6 外接插件脚本函数——欢迎各位体验各种便捷的功能😄

+ 可在RunAny中调用注册过的插件脚本内函数，实现功能联动！ **从此RunAny插件功能将向多面化自定义发展！** 

+ 增加"修改菜单"中对每项菜单项的图标修改功能
+ 更新RunAny插件对象注册工具`RunPlugins\RunAny_ObjReg.ahk`，下载新插件后会自动重启RunAny来生效，解决误以为插件无效的情况
+ 更新`ZzIcon.dll`，自己画了RunAny新图标，Z字图标保留在ZzIcon.dll第6位并新增3个Z字图标
+ 升级URLDownloadToFile下载文件方法，提升速度100%，下载时不再造成脚本卡顿


## 【RunAny】v5.5.1 ~ v5.5.4
RunAny一键公式计算

![RunAny公式计算](/assets/images/RunAny公式计算.gif)

+ 菜单显示选中的文字信息提示，点击复制到剪贴板(可在设置中隐藏)

  隐藏配置ShowGetZzLen=30为默认截取信息长度
+ 新增隐藏配置HideMenuAppIcon，在指定菜单内禁用EXE图标

+ 新增隐藏配置ClipWaitApp

  设置哪些配合ClipWaitTime剪贴板等待时间生效的应用

## 【RunAny】v5.5.0
+ 使用自定义软件打开菜单内不同后缀的文件(合并原来TC打开目录功能)
  + 如设置文件后缀：`txt`打开方式为`notepad2.exe`，则RunAny菜单中所有txt文件，默认将以notepad2打开而不是系统默认打开方式，绿色软件运行生态闭环！不用头疼文件关联绿色软件问题
  + 特殊后缀：`folder` 打开方式为`TotalCMD64.exe /O /S`，就实现原来用TC打开RunAny菜单中目录的功能
+ 全菜单图标自定义
  + 设置图标识别库文件夹
  + 把菜单项名相同(不包含后面热键)的图标或图片文件放入图标库
  + 如：`QQ.png`，`百度(&B).ico`
  + 菜单需要保留前面的横杠，如：`-常用(&App).jpg`
+ 现在RunAny热键映射支持映射触发其他AHK脚本内的热键！
  + 写法为key末尾加三个冒号，`ahk脚本|!r:::`
  + 也可以触发RunAny菜单配置热键，`修改菜单|+{F2}:::`
+ 后缀菜单现在支持选中目录出专属菜单，设置为：`-资源管理|folder`

## 【RunAny】v5.4.3 ~ v5.4.9
* 修复一键搜索带空格关键词搜两次的问题
* 重启后依然保留最近运行项
* 修复插件路径有空格启动出错的问题

## 【RunAny】v5.4.2
+ 加入RunAny托盘菜单的热键设置
+ 支持浏览器和TC无路径识别
+ 支持直接拖拽文件 到 修改菜单界面 和 新增菜单项界面
* 优化多选导入和批量导入，支持选中分类名导入到该分类下

## 【RunAny】v5.4 正式版
+ 增加插件管理功能
+ 增加插件：RunAny菜单自动透明、鼠标中键自由拖拽窗口、定时提醒休息时间
  + 插件自动检测RunPlugins下所有ahk文件和子目录下同名ahk，如\RunPlugins\a.ahk和\RunPlugins\abc\abc.ahk
+ 一键网址和搜索支持用非默认浏览器打开
+ （增加一个隐藏配置JumpSearch=1可以跳过批量搜索的确认弹窗）

#### RunAny菜单多种使用方式：
![RunAny菜单多种使用方式](/assets/images/RunAny菜单多种使用方式.gif)

#### RunAny一键直达功能：
![RunAny一键直达功能](/assets/images/RunAny一键直达功能.gif)

#### RunAny短语和热键映射功能：
![RunAny短语和热键映射功能](/assets/images/RunAny短语和热键映射功能.gif)

## 【RunAny】v5.3.7 正式版

### 【RunAny】v5.3.6 Beta
* 继续优化添加修改菜单项的操作界面
* Everything和TotalCommander路径支持AHK内置变量
* 一级菜单被手动注释后，忽略其下子菜单和子项
* 优化菜单1、菜单2操作，一键网址、文件、目录、磁力只在菜单1有效，结合菜单2有更多操作功能
+ 增加隐藏配置ClipWaitTime，默认0.1（等待剪贴板时间，改小会加快普通无选中菜单的弹出速度，但是改太小会导致选中文件菜单没获取到文件就弹出菜单）

### 【RunAny】v5.3.5 Beta
+ 支持批量多文件选中用应用打开。同时支持用应用的全局热键。
+ 支持一键批量识别打开：多文件路径、多目录路径、多网址、多磁力链接。同时支持用应用的全局热键来识别。
+ 修改菜单界面增加批量注释功能
* 优化设置界面重置按钮

### 【RunAny】v5.3.4 Beta
* 去掉菜单顶部分割线，默认回车运行第一项
* 优化“修改菜单”窗口菜单树的显示和操作
* 只在手动检查更新时提示已经是最新版本，后台自动检查更新不提示，时间为每月的1号和15号

## 【RunAny】v5.3.3 任意菜单可自定义全局热键

## 【RunAny】v5.3.2 Beta
+ 支持AHK内置变量和环境变量
+ 支持短语变量实时输出、支持相对路径应用
+ 网址关键词%S大写后为URL编码后搜索
+ 选中文件的后缀菜单中只有一个执行项时直接启动

## 【RunAny】v5.3.1 Beta
* 修复编辑保存菜单项的无效的问题
+ 增加菜单项是否支持无路径的提示

## 【RunAny】 v5.3
+ 选中文件后可以直接添加到RunAny菜单中（按住Ctrl键可以添加到具体位置）
+ 新增选中磁力链接一键下载（使用默认下载软件）
+ 菜单树添加、编辑项使用全界面控件，不用手打热键和Tab、竖|，清晰方便
+ 新增Everything自动关闭选项
+ 新增发送热键功能，末尾两个冒号`::`（如`Win+D`格式为 `#{d}::`）
* RunAny默认排除掉Everything回收站文件列表
* 初始化时不再把桌面所有子目录exe加入RunAny
* 优化RunAnyConfig.ini本地绿色化配置
* 优化提示信息和初始菜单内容

## 【RunAny】 v5.2
* 现在RunAny发现Everything没有权限、未创建索引时将最长等待30秒(感谢skystar提出问题)

## 【RunAny】 v5.1 增加更新版本功能
+ 每月1日自动检查版本更新，也可在托盘右键菜单手动更新
+ 优化了RunAny的初始化配置和使用说明
* 修复系统未安装ahk环境下出现的错误
* 修复全路径应用项偶尔图标加载失败的错误

# 【RunAny】 v5.0 重构代码加快菜单初始化速度
+ 内置Everything，便于新手使用
* 优化修复了一些问题
* 修复打开自定义目录末尾没有\报错，现在有和没有\都可以

## 【RunAny】 v4.7 ~ 4.9 带参启动，菜单多用，配置热键
* 修复只有菜单1时热键失效的BUG
* 修复打开目录跳转到上级的BUG
+ **增加RunAny所有配置热键**
+ **启动软件支持带参数**
+ **选中不同后缀文件，出现不同菜单**

## 【RunAny】 v4.3 ~ 4.6 热键直达,透明启动
+ **新增所有软件、网址、短语等自定义热键设置**
+ **新增所有软件的透明化启动方式**
* 优化加快重启RunAny的速度

## 【RunAny】 v4.2 一键直达，一步到位
+ **新增选中网址、目录、文件路径文字后一键直达**
+ 新增使用ini文件配置绿色化，方便U盘便携
+ 选中文字后菜单增加短语，方便替换文本
+ 现在可自定义菜单里显示不同类型的项目
* 修复不能注释目录的情况

## 【RunAny】 v4.1 Run Anything!
+ 增加菜单1和2的树形快捷管理按键设置
+ 一键搜索网址现在支持一次搜索多个网址
* **启动菜单显示速度加快100%**

# 【RunAny】 v4.0 Run Anything!
+ 程序菜单可显示任意后缀文件的图标
+ [修改菜单]也可显示任意后缀文件图标
+ 在已有一个菜单再增加一个菜单，更加强大
+ 现在可以自定义Everything的搜索参数！
  在参数中添加任意后缀，该后缀文件便无需路径在RunAny中运行

## 【RunAny】 v3.1 ~ v3.9
+ v3.2 双重菜单➿
+ 新增[修改菜单]中树节点上下移动功能，便捷大提升
* 重新设计了[设置RunAny]的Gui界面
* 优化了初始菜单的名称
* 修复运行一些软件工作目录变为RunAny目录的问题
* 修复单个搜索关键词没与%s替代而在末尾的问题

# 【RunAny】v3.0 批量搜索🔍
+ 选中文本只弹出网址菜单搜索(也可在配置中取消)
+ **增加批量打开网址和选中文字批量搜索功能！**
+ 菜单配置中添加/修改/移动后通过Everything显示应用图标

## 【RunAny】v2.9
* 修复选中某些情况下选中文字文件RunAny未提取到的问题
* 批量网址下载失败情况，可单选某个网址修改下载地址再重新下载

## 【RunAny】v2.8
* 显示"多选导入"和"批量导入"的应用图标
+ 可以多选下载指定网址的图标

## 【RunAny】v2.7 极速🚀
+ 初始打开即可用，后台渐步加载应用图标，重启RunAny毫秒级加载

## 【RunAny】v2.6 图标优化🖼
+ 现在菜单配置中程序将显示自己的图标！
+ 在菜单配置加入"网站图标"功能，点击即可下载菜单中所有网站图标
  + 下载完成后网站无论是快捷启动还是菜单配置都将显示自己的图标
+ ZzIcon.dll中加入树节点、移动、上、下4个图标，更好的支持xp系统

## 【RunAny】v2.5 组合功能🔩
+ **先选中文件，然后RunAny中运行程序将打开选中的文件**
  + 如在资源管理器先选中1.txt，再按启动RunAny中notepad.exe就打开了1.txt
+ **先选中文字，然后RunAny运行网址将文件作为搜索条件**
  + 如先选中"关键字"，再启动RunAny中的百度(&B)|https://www.baidu.com/s?wd=，就变成了搜索"关键字"
+ **菜单配置增加有复选框**
  + TreeView的全选全不选功能
  + 批量移动项目到指定的节点下，并自动匹配级别
  + 批量勾选项目删除

## 【RunAny】v2.4 便利
+ 新增一键搜索选中文字
+ 记录最近运行程序
* 独立导入桌面程序功能

## 【RunAny】v2.3
+ 支持Ctrl键用TC打开应用目录
* 修复不能正确打开带空格路径
* 重置功能取消开机自动启动

## 【RunAny】v2.2 快捷🎈
+ **增加快捷方式lnk全盘路径和图标识别**
+ **增加开机自动选项**
+ **增加一键Everything[搜索选中文字][激活][隐藏]**
+ *增加输出简单短语的功能*
+ *新增屏蔽RunAny热键的程序列表*
+ *支持TotalCommander打开文件夹*
+ ~~现在可以隐藏失效的项目~~
+ 菜单编辑添加树时自动为其增加子项目
+ 初次运行的菜单配置增加了通用分类和流行软件
+ 初次运行自动添加桌面快捷方式
* 修复菜单删除项目时Del与删文字冲突
* 修复了批量导入问题且现在可以导入快捷方式
* 修正了网址的正则

## 【RunAny】v2.1 酷炫😉
+ 批量导入程序名称
+ 图标自定义化(包括托盘图标)
+ 优化搜索条件，排除C:\Windows及其他升级文件夹
* 现在会自动检查Everything.dll的可用性，需要用Everything64.dll时提示

# v2.0 正式更名为RunAny，易用性大幅提升，兼容菜单文件编辑和GUI界面编辑

## v1.9 自定义配置优化

+ 添加Everything路径配置选项
+ 添加显示热键自定义配置选项
+ 菜单配置现在单独保存在RunMenuZz.ini
+ 只有在用户设置与默认不同才将配置保存在注册表HKEY_CURRENT_USER\Software\RunAny
+ 添加重置按钮，清除注册表配置，不留痕迹

## v1.8 集成Everything自动检索程序，从此程序随便放目录都能用RunMenu运行了😀
